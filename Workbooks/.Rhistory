theme(strip.text.x = element_text(size =8,angle = 0, hjust = 0.5, vjust = 0, margin = margin(b = 6)))
dev.off()
ggplot(df, aes(x = DaysFD, y = Proportion *1000, color = Celltypes)) +
geom_point() +
stat_summary(data = mean_df, aes(x = DaysFD, y = MeanProportion *1000, group = Celltypes),
fun = "mean", geom = "line", linetype = "solid", size = 1) +
labs(title = "Mean Proportion vs. DaysFD",
x = "DaysFD",
y = "Percent of total cells",
color = "Celltypes") +
scale_color_manual(name = "Celltypes", values = clust.colours) +
facet_wrap(~Celltypes, scales = "free_y") + # Split by facets
theme(strip.text.x = element_text(size =8,angle = 0, hjust = 0.5, vjust = 0, margin = margin(b = 6)))
setwd("/Users/rhalenathomas/Documents/Data/FlowCytometry/PhenoID/TimeCourseAIW/Analysis/Figure7/")
png("LinePlotPercentbyTime.csv")
ggplot(df, aes(x = DaysFD, y = Proportion *1000, color = Celltypes)) +
geom_point() +
stat_summary(data = mean_df, aes(x = DaysFD, y = MeanProportion *1000, group = Celltypes),
fun = "mean", geom = "line", linetype = "solid", size = 1) +
labs(title = "Mean Proportion vs. DaysFD",
x = "DaysFD",
y = "Percent of total cells",
color = "Celltypes") +
scale_color_manual(name = "Celltypes", values = clust.colours) +
facet_wrap(~Celltypes, scales = "free_y") + # Split by facets
theme(strip.text.x = element_text(size =8,angle = 0, hjust = 0.5, vjust = 0, margin = margin(b = 6)))
dev.off()
# Create the plot
ggplot(df, aes(x = DaysFD, y = Proportion *1000, color = Celltypes)) +
geom_point() +
stat_summary(data = mean_df, aes(x = DaysFD, y = MeanProportion *1000, group = Celltypes),
fun = "mean", geom = "line", linetype = "solid", size = 1) +
labs(title = "Mean Proportion vs. DaysFD",
x = "DaysFD",
y = "Percent of total cells",
color = "Celltypes") +
scale_color_manual(name = "Celltypes", values = clust.colours) +
facet_wrap(~Celltypes, scales = "free_y") + # Split by facets
theme(strip.text.x = element_text(size =8,angle = 0, hjust = 0.5, vjust = 0, margin = margin(b = 6)))
setwd("/Users/rhalenathomas/Documents/Data/FlowCytometry/PhenoID/TimeCourseAIW/Analysis/Figure7/")
png("LinePlotPercentbyTime.png")
ggplot(df, aes(x = DaysFD, y = Proportion *1000, color = Celltypes)) +
geom_point() +
stat_summary(data = mean_df, aes(x = DaysFD, y = MeanProportion *1000, group = Celltypes),
fun = "mean", geom = "line", linetype = "solid", size = 1) +
labs(title = "Mean Proportion vs. DaysFD",
x = "DaysFD",
y = "Percent of total cells",
color = "Celltypes") +
scale_color_manual(name = "Celltypes", values = clust.colours) +
facet_wrap(~Celltypes, scales = "free_y") + # Split by facets
theme(strip.text.x = element_text(size =8,angle = 0, hjust = 0.5, vjust = 0, margin = margin(b = 6)))
dev.off()
setwd("/Users/rhalenathomas/Documents/Data/FlowCytometry/PhenoID/TimeCourseAIW/Analysis/Figure7/")
png("LinePlotPercentbyTime.png", width = 800, height = 800)
ggplot(df, aes(x = DaysFD, y = Proportion *1000, color = Celltypes)) +
geom_point() +
stat_summary(data = mean_df, aes(x = DaysFD, y = MeanProportion *1000, group = Celltypes),
fun = "mean", geom = "line", linetype = "solid", size = 1) +
labs(title = "Mean Proportion vs. DaysFD",
x = "DaysFD",
y = "Percent of total cells",
color = "Celltypes") +
scale_color_manual(name = "Celltypes", values = clust.colours) +
facet_wrap(~Celltypes, scales = "free_y") + # Split by facets
theme(strip.text.x = element_text(size =8,angle = 0, hjust = 0.5, vjust = 0, margin = margin(b = 6)))
dev.off()
setwd("/Users/rhalenathomas/Documents/Data/FlowCytometry/PhenoID/TimeCourseAIW/Analysis/Figure7/")
png("LinePlotPercentbyTime.png", width = 600, height = 500)
ggplot(df, aes(x = DaysFD, y = Proportion *1000, color = Celltypes)) +
geom_point() +
stat_summary(data = mean_df, aes(x = DaysFD, y = MeanProportion *1000, group = Celltypes),
fun = "mean", geom = "line", linetype = "solid", size = 1) +
labs(title = "Mean Proportion vs. DaysFD",
x = "DaysFD",
y = "Percent of total cells",
color = "Celltypes") +
scale_color_manual(name = "Celltypes", values = clust.colours) +
facet_wrap(~Celltypes, scales = "free_y") + # Split by facets
theme(strip.text.x = element_text(size =8,angle = 0, hjust = 0.5, vjust = 0, margin = margin(b = 6)))
dev.off()
setwd("/Users/rhalenathomas/Documents/Data/FlowCytometry/PhenoID/TimeCourseAIW/Analysis/Figure7/")
pdf("LinePlotPercentbyTime.pdf", width = 6, height = 5)
ggplot(df, aes(x = DaysFD, y = Proportion *1000, color = Celltypes)) +
geom_point() +
stat_summary(data = mean_df, aes(x = DaysFD, y = MeanProportion *1000, group = Celltypes),
fun = "mean", geom = "line", linetype = "solid", size = 1) +
labs(title = "Mean Proportion vs. DaysFD",
x = "DaysFD",
y = "Percent of total cells",
color = "Celltypes") +
scale_color_manual(name = "Celltypes", values = clust.colours) +
facet_wrap(~Celltypes, scales = "free_y") + # Split by facets
theme(strip.text.x = element_text(size =8,angle = 0, hjust = 0.5, vjust = 0, margin = margin(b = 6)))
dev.off()
setwd("/Users/rhalenathomas/Documents/Data/FlowCytometry/PhenoID/TimeCourseAIW/Analysis/Figure7/")
pdf("LinePlotPercentbyTime.pdf", width = 6, height = 4)
ggplot(df, aes(x = DaysFD, y = Proportion *1000, color = Celltypes)) +
geom_point() +
stat_summary(data = mean_df, aes(x = DaysFD, y = MeanProportion *1000, group = Celltypes),
fun = "mean", geom = "line", linetype = "solid", size = 1) +
labs(title = "Mean Proportion vs. DaysFD",
x = "DaysFD",
y = "Percent of total cells",
color = "Celltypes") +
scale_color_manual(name = "Celltypes", values = clust.colours) +
facet_wrap(~Celltypes, scales = "free_y") + # Split by facets
theme(strip.text.x = element_text(size =8,angle = 0, hjust = 0.5, vjust = 0, margin = margin(b = 6)))
dev.off()
setwd("/Users/rhalenathomas/Documents/Data/FlowCytometry/PhenoID/TimeCourseAIW/Analysis/Figure7/")
pdf("LinePlotPercentbyTime.pdf", width = 8, height = 6)
ggplot(df, aes(x = DaysFD, y = Proportion *1000, color = Celltypes)) +
geom_point() +
stat_summary(data = mean_df, aes(x = DaysFD, y = MeanProportion *1000, group = Celltypes),
fun = "mean", geom = "line", linetype = "solid", size = 1) +
labs(title = "Mean Proportion vs. DaysFD",
x = "DaysFD",
y = "Percent of total cells",
color = "Celltypes") +
scale_color_manual(name = "Celltypes", values = clust.colours) +
facet_wrap(~Celltypes, scales = "free_y") + # Split by facets
theme(strip.text.x = element_text(size =8,angle = 0, hjust = 0.5, vjust = 0, margin = margin(b = 6)))
dev.off()
Idents(seu.t) <- "Days_in_FD"
levels(seu.t)
days <- c("38","63","98","155")
seu2 <- annotate(seu2, annotations = days, to_label = "Days_in_FD",
annotation_name = "Days_in_FD")
seu.t <- annotate(seu.t, annotations = days, to_label = "Days_in_FD",
annotation_name = "Days_in_FD")
df <- as.data.frame(proportions(table(seu.t$CelltypesMainNew,seu.t$Days_in_FD,seu.t$Replicate)))
colnames(df) <- c("Celltypes","DaysFD","Replicate","Proportion")
head(df)
# Create the plot
ggplot(df, aes(x = DaysFD, y = Proportion *1000, color = Celltypes)) +
geom_point() +
stat_summary(data = mean_df, aes(x = DaysFD, y = MeanProportion *1000, group = Celltypes),
fun = "mean", geom = "line", linetype = "solid", size = 1) +
labs(title = "Mean Proportion vs. DaysFD",
x = "DaysFD",
y = "Percent of total cells",
color = "Celltypes") +
scale_color_manual(name = "Celltypes", values = clust.colours) +
facet_wrap(~Celltypes, scales = "free_y") + # Split by facets
theme(strip.text.x = element_text(size =8,angle = 0, hjust = 0.5, vjust = 0, margin = margin(b = 6)))
setwd("/Users/rhalenathomas/Documents/Data/FlowCytometry/PhenoID/TimeCourseAIW/Analysis/Figure7/")
pdf("LinePlotPercentbyTime.pdf", width = 8, height = 6)
ggplot(df, aes(x = DaysFD, y = Proportion *1000, color = Celltypes)) +
geom_point() +
stat_summary(data = mean_df, aes(x = DaysFD, y = MeanProportion *1000, group = Celltypes),
fun = "mean", geom = "line", linetype = "solid", size = 1) +
labs(title = "Mean Proportion vs. DaysFD",
x = "DaysFD",
y = "Percent of total cells",
color = "Celltypes") +
scale_color_manual(name = "Celltypes", values = clust.colours) +
facet_wrap(~Celltypes, scales = "free_y") + # Split by facets
theme(strip.text.x = element_text(size =8,angle = 0, hjust = 0.5, vjust = 0, margin = margin(b = 6)))
dev.off()
setwd("/Users/rhalenathomas/Documents/Data/FlowCytometry/PhenoID/TimeCourseAIW/Analysis/Figure7/")
pdf("LinePlotPercentbyTime.pdf", width = 10, height = 7)
ggplot(df, aes(x = DaysFD, y = Proportion *1000, color = Celltypes)) +
geom_point() +
stat_summary(data = mean_df, aes(x = DaysFD, y = MeanProportion *1000, group = Celltypes),
fun = "mean", geom = "line", linetype = "solid", size = 1) +
labs(title = "Mean Proportion vs. DaysFD",
x = "DaysFD",
y = "Percent of total cells",
color = "Celltypes") +
scale_color_manual(name = "Celltypes", values = clust.colours) +
facet_wrap(~Celltypes, scales = "free_y") + # Split by facets
theme(strip.text.x = element_text(size =8,angle = 0, hjust = 0.5, vjust = 0, margin = margin(b = 6)))
dev.off()
View(df)
seu.t$Days_in_FD <- factor(seu.t$Days_in_FD, levels = c("38","63","98","155"))
df <- as.data.frame(proportions(table(seu.t$CelltypesMainNew,seu.t$Days_in_FD,seu.t$Replicate)))
colnames(df) <- c("Celltypes","DaysFD","Replicate","Proportion")
head(df)
# Create the plot
ggplot(df, aes(x = DaysFD, y = Proportion *1000, color = Celltypes)) +
geom_point() +
stat_summary(data = mean_df, aes(x = DaysFD, y = MeanProportion *1000, group = Celltypes),
fun = "mean", geom = "line", linetype = "solid", size = 1) +
labs(title = "Mean Proportion vs. DaysFD",
x = "DaysFD",
y = "Percent of total cells",
color = "Celltypes") +
scale_color_manual(name = "Celltypes", values = clust.colours) +
facet_wrap(~Celltypes, scales = "free_y") + # Split by facets
theme(strip.text.x = element_text(size =8,angle = 0, hjust = 0.5, vjust = 0, margin = margin(b = 6)))
setwd("/Users/rhalenathomas/Documents/Data/FlowCytometry/PhenoID/TimeCourseAIW/Analysis/Figure7/")
pdf("LinePlotPercentbyTime.pdf", width = 10, height = 7)
ggplot(df, aes(x = DaysFD, y = Proportion *1000, color = Celltypes)) +
geom_point() +
stat_summary(data = mean_df, aes(x = DaysFD, y = MeanProportion *1000, group = Celltypes),
fun = "mean", geom = "line", linetype = "solid", size = 1) +
labs(title = "Mean Proportion vs. DaysFD",
x = "DaysFD",
y = "Percent of total cells",
color = "Celltypes") +
scale_color_manual(name = "Celltypes", values = clust.colours) +
facet_wrap(~Celltypes, scales = "free_y") + # Split by facets
theme(strip.text.x = element_text(size =8,angle = 0, hjust = 0.5, vjust = 0, margin = margin(b = 6)))
dev.off()
View(df)
head(df)
df$DaysFD <- reorder(df$DaysFD, as.numeric(df$DaysFD))
# Create the plot
ggplot(df, aes(x = DaysFD, y = Proportion *1000, color = Celltypes)) +
geom_point() +
stat_summary(data = mean_df, aes(x = DaysFD, y = MeanProportion *1000, group = Celltypes),
fun = "mean", geom = "line", linetype = "solid", size = 1) +
labs(title = "Mean Proportion vs. DaysFD",
x = "DaysFD",
y = "Percent of total cells",
color = "Celltypes") +
scale_color_manual(name = "Celltypes", values = clust.colours) +
facet_wrap(~Celltypes, scales = "free_y") + # Split by facets
theme(strip.text.x = element_text(size =8,angle = 0, hjust = 0.5, vjust = 0, margin = margin(b = 6)))
setwd("/Users/rhalenathomas/Documents/Data/FlowCytometry/PhenoID/TimeCourseAIW/Analysis/Figure7/")
pdf("LinePlotPercentbyTime.pdf", width = 10, height = 7)
ggplot(df, aes(x = DaysFD, y = Proportion *1000, color = Celltypes)) +
geom_point() +
stat_summary(data = mean_df, aes(x = DaysFD, y = MeanProportion *1000, group = Celltypes),
fun = "mean", geom = "line", linetype = "solid", size = 1) +
labs(title = "Mean Proportion vs. DaysFD",
x = "DaysFD",
y = "Percent of total cells",
color = "Celltypes") +
scale_color_manual(name = "Celltypes", values = clust.colours) +
facet_wrap(~Celltypes, scales = "free_y") + # Split by facets
theme(strip.text.x = element_text(size =8,angle = 0, hjust = 0.5, vjust = 0, margin = margin(b = 6)))
dev.off()
unique(df$DaysFD)
df$DaysFD <- factor(df$DaysFD, levels = c(38, 63, 98, 155))
ggplot(df, aes(x = DaysFD, y = Proportion *1000, color = Celltypes)) +
geom_point() +
stat_summary(data = mean_df, aes(x = DaysFD, y = MeanProportion *1000, group = Celltypes),
fun = "mean", geom = "line", linetype = "solid", size = 1) +
labs(title = "Mean Proportion vs. DaysFD",
x = "DaysFD",
y = "Percent of total cells",
color = "Celltypes") +
scale_color_manual(name = "Celltypes", values = clust.colours) +
facet_wrap(~Celltypes, scales = "free_y") + # Split by facets
theme(strip.text.x = element_text(size =8,angle = 0, hjust = 0.5, vjust = 0, margin = margin(b = 6)))
unique(df$DaysFD)
Idents(seu.t) <- "Days_in_FD"
DimPlot(seu.t)
proportionplots(seu.t,seu.var = seu.t$Days_in_FD, seu.lable = seu.t$CelltypesMainNew, groups = "Days_in_FD", my_colours = clust.colours)
proportionplots(seu.t,seu.var = seu.t$Sample, seu.lable = seu.t$CelltypesMainNew, groups = "Days in FD and replicates", my_colours = clust.colours)
df <- as.data.frame(proportions(table(seu.t$CelltypesMainNew,seu.t$Days_in_FD,seu.t$Replicate)))
colnames(df) <- c("Celltypes","DaysFD","Replicate","Proportion")
head(df)
ggplot(df, aes(x = DaysFD, y = Proportion *1000, color = Celltypes)) +
geom_point() +
stat_summary(data = mean_df, aes(x = DaysFD, y = MeanProportion *1000, group = Celltypes),
fun = "mean", geom = "line", linetype = "solid", size = 1) +
labs(title = "Mean Proportion vs. DaysFD",
x = "DaysFD",
y = "Percent of total cells",
color = "Celltypes") +
scale_color_manual(name = "Celltypes", values = clust.colours) +
facet_wrap(~Celltypes, scales = "free_y") + # Split by facets
theme(strip.text.x = element_text(size =8,angle = 0, hjust = 0.5, vjust = 0, margin = margin(b = 6)))
View(df)
ggplot(df, aes(x = DaysFD, y = Proportion *1000, color = Celltypes)) +
geom_point() +
stat_summary(data = mean_df, aes(x = DaysFD, y = MeanProportion *1000, group = Celltypes),
fun = "mean", geom = "line", linetype = "solid", size = 1)
ggplot(df, aes(x = DaysFD, y = Proportion *1000, color = Celltypes)) +
geom_point() +
stat_summary(data = mean_df, aes(x = DaysFD, y = MeanProportion *1000, group = Celltypes),
fun = "mean", geom = "line", linetype = "solid", size = 1) +
labs(title = "Mean Proportion vs. DaysFD",
x = "DaysFD",
y = "Percent of total cells",
color = "Celltypes") +
scale_color_manual(name = "Celltypes", values = clust.colours) +
facet_wrap(~Celltypes, scales = "free_y") + # Split by facets
theme(strip.text.x = element_text(size =8,angle = 0, hjust = 0.5, vjust = 0, margin = margin(b = 6)))
df$DaysFD <- as.numeric(df$DaysFD)
# Create the plot
ggplot(df, aes(x = DaysFD, y = Proportion *1000, color = Celltypes)) +
geom_point() +
stat_summary(data = mean_df, aes(x = DaysFD, y = MeanProportion *1000, group = Celltypes),
fun = "mean", geom = "line", linetype = "solid", size = 1) +
labs(title = "Mean Proportion vs. DaysFD",
x = "DaysFD",
y = "Percent of total cells",
color = "Celltypes") +
scale_color_manual(name = "Celltypes", values = clust.colours) +
scale_x_continuous(breaks = c(38, 63, 98, 155)) +  # Set the desired breaks
facet_wrap(~Celltypes, scales = "free_y") + # Split by facets
theme(strip.text.x = element_text(size =8,angle = 0, hjust = 0.5, vjust = 0, margin = margin(b = 6)))
df$DaysFD <- as.numeric(as.character(df$DaysFD))
# Create the plot
ggplot(df, aes(x = DaysFD, y = Proportion *1000, color = Celltypes)) +
geom_point() +
stat_summary(data = mean_df, aes(x = DaysFD, y = MeanProportion *1000, group = Celltypes),
fun = "mean", geom = "line", linetype = "solid", size = 1) +
labs(title = "Mean Proportion vs. DaysFD",
x = "DaysFD",
y = "Percent of total cells",
color = "Celltypes") +
scale_color_manual(name = "Celltypes", values = clust.colours) +
scale_x_continuous(breaks = c(38, 63, 98, 155)) +  # Set the desired breaks
facet_wrap(~Celltypes, scales = "free_y") + # Split by facets
theme(strip.text.x = element_text(size =8,angle = 0, hjust = 0.5, vjust = 0, margin = margin(b = 6)))
ggplot(df, aes(x = DaysFD, y = Proportion *1000, color = Celltypes)) +
geom_point() +
stat_summary(data = mean_df, aes(x = DaysFD, y = MeanProportion *1000, group = Celltypes),
fun = "mean", geom = "line", linetype = "solid", size = 1) +
labs(title = "Mean Proportion vs. DaysFD",
x = "DaysFD",
y = "Percent of total cells",
color = "Celltypes") +
scale_color_manual(name = "Celltypes", values = clust.colours) +
scale_x_continuous(breaks = c(38, 63, 98, 155), labels = c(38, 63, 98, 155)) +  # Set the desired
facet_wrap(~Celltypes, scales = "free_y") + # Split by facets
theme(strip.text.x = element_text(size =8,angle = 0, hjust = 0.5, vjust = 0, margin = margin(b = 6)))
ggplot(df, aes(x = DaysFD, y = Proportion *1000, color = Celltypes)) +
geom_point() +
stat_summary(data = mean_df, aes(x = DaysFD, y = MeanProportion *1000, group = Celltypes),
fun = "mean", geom = "line", linetype = "solid", size = 1) +
labs(title = "Mean Proportion vs. DaysFD",
x = "DaysFD",
y = "Percent of total cells",
color = "Celltypes") +
scale_color_manual(name = "Celltypes", values = clust.colours) +
scale_x_discrete(limits = c(38, 63, 98, 155)) + # Set x-axis limits
facet_wrap(~Celltypes, scales = "free_y") + # Split by facets
theme(strip.text.x = element_text(size =8,angle = 0, hjust = 0.5, vjust = 0, margin = margin(b = 6)))
ggplot(df, aes(x = DaysFD, y = Proportion *1000, color = Celltypes)) +
geom_point() +
stat_summary(data = mean_df, aes(x = DaysFD, y = MeanProportion *1000, group = Celltypes),
fun = "mean", geom = "line", linetype = "solid", size = 1) +
labs(title = "Mean Proportion vs. DaysFD",
x = "DaysFD",
y = "Percent of total cells",
color = "Celltypes") +
scale_color_manual(name = "Celltypes", values = clust.colours) +
scale_x_discrete() + # Set x-axis limits
facet_wrap(~Celltypes, scales = "free_y") + # Split by facets
theme(strip.text.x = element_text(size =8,angle = 0, hjust = 0.5, vjust = 0, margin = margin(b = 6)))
ggplot(df, aes(x = DaysFD, y = Proportion *1000, color = Celltypes)) +
geom_point() +
stat_summary(data = mean_df, aes(x = DaysFD, y = MeanProportion *1000, group = Celltypes),
fun = "mean", geom = "line", linetype = "solid", size = 1) +
labs(title = "Mean Proportion vs. DaysFD",
x = "DaysFD",
y = "Percent of total cells",
color = "Celltypes") +
scale_color_manual(name = "Celltypes", values = clust.colours) +
scale_x_discrete(breaks = c(38, 63, 98, 155)) + # Set x-axis limits
facet_wrap(~Celltypes, scales = "free_y") + # Split by facets
theme(strip.text.x = element_text(size =8,angle = 0, hjust = 0.5, vjust = 0, margin = margin(b = 6)))
ggplot(df, aes(x = factor(DaysFD, levels = c(38, 63, 98, 155)), y = Proportion * 1000, color = Celltypes)) +
geom_point() +
stat_summary(data = mean_df, aes(x = factor(DaysFD, levels = c(38, 63, 98, 155)), y = MeanProportion * 1000, group = Celltypes),
fun = "mean", geom = "line", linetype = "solid", size = 1) +
labs(title = "Mean Proportion vs. DaysFD",
x = "DaysFD",
y = "Percent of total cells",
color = "Celltypes") +
scale_color_manual(name = "Celltypes", values = clust.colours) +
scale_x_discrete(breaks = c(38, 63, 98, 155)) + # Set x-axis breaks (labels)
facet_wrap(~Celltypes, scales = "free_y") + # Split by facets
theme(strip.text.x = element_text(size = 8, angle = 0, hjust = 0.5, vjust = 0, margin = margin(b = 6)))
setwd("/Users/rhalenathomas/Documents/Data/FlowCytometry/PhenoID/TimeCourseAIW/Analysis/Figure7/")
pdf("LinePlotPercentbyTime.pdf", width = 10, height = 7)
ggplot(df, aes(x = DaysFD, y = Proportion *1000, color = Celltypes)) +
geom_point() +
stat_summary(data = mean_df, aes(x = DaysFD, y = MeanProportion *1000, group = Celltypes),
fun = "mean", geom = "line", linetype = "solid", size = 1) +
labs(title = "Mean Proportion vs. DaysFD",
x = "DaysFD",
y = "Percent of total cells",
color = "Celltypes") +
scale_color_manual(name = "Celltypes", values = clust.colours) +
scale_x_discrete(breaks = c(38, 63, 98, 155)) + # Set x-axis limits
facet_wrap(~Celltypes, scales = "free_y") + # Split by facets
theme(strip.text.x = element_text(size =8,angle = 0, hjust = 0.5, vjust = 0, margin = margin(b = 6)))
dev.off()
ggplot(df, aes(x = DaysFD, y = Proportion *1000, color = Celltypes)) +
geom_point() +
stat_summary(data = mean_df, aes(x = DaysFD, y = MeanProportion *1000, group = Celltypes),
fun = "mean", geom = "line", linetype = "solid", size = 1) +
labs(title = "Mean Proportion vs. DaysFD",
x = "DaysFD",
y = "Percent of total cells",
color = "Celltypes") +
scale_color_manual(name = "Celltypes", values = clust.colours) +
scale_x_discrete() + # Set x-axis limits
facet_wrap(~Celltypes, scales = "free_y") + # Split by facets
theme(strip.text.x = element_text(size =8,angle = 0, hjust = 0.5, vjust = 0, margin = margin(b = 6)))
setwd("/Users/rhalenathomas/Documents/Data/FlowCytometry/PhenoID/TimeCourseAIW/Analysis/Figure7/")
pdf("LinePlotPercentbyTime.pdf", width = 10, height = 7)
ggplot(df, aes(x = DaysFD, y = Proportion *1000, color = Celltypes)) +
geom_point() +
stat_summary(data = mean_df, aes(x = DaysFD, y = MeanProportion *1000, group = Celltypes),
fun = "mean", geom = "line", linetype = "solid", size = 1) +
labs(title = "Mean Proportion vs. DaysFD",
x = "DaysFD",
y = "Percent of total cells",
color = "Celltypes") +
scale_color_manual(name = "Celltypes", values = clust.colours) +
scale_x_discrete() + # Set x-axis limits
facet_wrap(~Celltypes, scales = "free_y") + # Split by facets
theme(strip.text.x = element_text(size =8,angle = 0, hjust = 0.5, vjust = 0, margin = margin(b = 6)))
dev.off()
library(hypergate)
seu <- readRDS("/Users/rhalenathomas/Documents/Data/FlowCytometry/PhenoID/Analysis/NatMethodJuneSubmission/Figure4/All9MOannaoteAug.RDS")
Idents(seu) <- "Celltypes"
levels(seu)
new.ids <- c("Astrocytes", "Astrocytes", "RadialGlia", "RadialGlia", "RadialGlia", "RadialGlia", "Glia-lineage",
"Epithelial", "Endothelial", "Neurons1", "Neurons2", "NPC", "Neural-lineage", "Oligodendrocytes",
"OPC", "OPC-like", "Stemlike")
seu <- annotate(seu, annotations = new.ids,
to_label= "Celltypes",
annotation_name = "GatingCells")
DimPlot(seu, group.by = "Celltypes", raster = FALSE, label = TRUE)
DimPlot(seu, group.by = "GatingCells", raster = FALSE, label = TRUE)
library(Seurat)
library(tidyverse)
library(CelltypeR)
library(hypergate)
table(seu$GatingCells)
# set the identity to the labels to by the hypergate input
Idents(seu.r) <- 'cell.types'
# set the identity to the labels to by the hypergate input
Idents(seu) <- 'cell.types'
# down sample
i = 2000
set.seed(i)
seu.down <- subset(x= seu, downsample = i)
DimPlot(seu.down)
table(seu.down$GatingCells)
# create a matrix to be the input for hypergate
input.xm = as.matrix(GetAssayData(seu.down, slot = 'data'))
xm.t <- t(input.xm)
cluster.labels <- as.vector(seu.down$GatingCells)
# set the identity to the labels to by the hypergate input
Idents(seu) <- 'GatingCells'
# down sample
i = 2000
set.seed(i)
seu.down <- subset(x= seu, downsample = i)
DimPlot(seu.down)
table(seu.down$GatingCells)
# create a matrix to be the input for hypergate
input.xm = as.matrix(GetAssayData(seu.down, slot = 'data'))
xm.t <- t(input.xm)
cluster.labels <- as.vector(seu.down$GatingCells)
DimPlot(seu.down, label = TRUE)
# make a vector of all the cells to gate
# first I will gate with all cell types
# the number of cells included will alter the gates
cell.types <- c("Astrocytes",  "RadialGlia",  "RadialGlia", "Glia-lineage",
"Epithelial", "Endothelial", "Neurons1", "Neurons2", "NPC", "Neural-lineage", "Oligodendrocytes",
"OPC", "OPC-like", "Stemlike")
# run gating and get the output
for (cell in cell.types) {
hg_output <- hypergate(xp = xm.t, gate_vector = cluster.labels, level = cell)
gating_predicted = subset_matrix_hg(hg_output,xm.t)
conf.table <- table(ifelse(gating_predicted, "Gated-in", "Gated-out"), ifelse(cluster.labels ==  cell, cell, "Others"))
print(cell)
print(conf.table)
print(hgate_rule(hg_output))
}
cell.types <- c("RadialGlia","Stemlike")
# run gating and get the output
for (cell in cell.types) {
hg_output <- hypergate(xp = xm.t, gate_vector = cluster.labels, level = cell)
gating_predicted = subset_matrix_hg(hg_output,xm.t)
conf.table <- table(ifelse(gating_predicted, "Gated-in", "Gated-out"), ifelse(cluster.labels ==  cell, cell, "Others"))
print(cell)
print(conf.table)
print(hgate_rule(hg_output))
}
i = 800
set.seed(i)
seu.down <- subset(x= seu, downsample = i)
DimPlot(seu.down, label = TRUE)
table(seu.down$GatingCells)
# create a matrix to be the input for hypergate
input.xm = as.matrix(GetAssayData(seu.down, slot = 'data'))
xm.t <- t(input.xm)
cluster.labels <- as.vector(seu.down$GatingCells)
cell.types <- c("Astrocytes",  "RadialGlia", "Glia-lineage",
"Epithelial", "Endothelial", "Neurons1", "Neurons2", "NPC", "Neural-lineage", "Oligodendrocytes",
"OPC", "OPC-like", "Stemlike")
# run gating and get the output
for (cell in cell.types) {
hg_output <- hypergate(xp = xm.t, gate_vector = cluster.labels, level = cell)
gating_predicted = subset_matrix_hg(hg_output,xm.t)
conf.table <- table(ifelse(gating_predicted, "Gated-in", "Gated-out"), ifelse(cluster.labels ==  cell, cell, "Others"))
print(cell)
print(conf.table)
print(hgate_rule(hg_output))
}
Sys.time()
library(Seurat)
library(tidyverse)
library(DoubletFinder)
library(Seurat, lib.loc = "/Users/rhalenathomas/Library/CustomR")
# Check Seurat version
packageVersion("Seurat")
library(Seurat, lib.loc = "/Users/rhalenathomas/Library/CustomR")
packageVersion("Seurat")
library(Seurat, lib.loc = "/Users/rhalenathomas/Library/CustomR/")
packageVersion("Seurat")
