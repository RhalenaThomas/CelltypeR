---
title: "R Notebook"
output: html_notebook
---

compare groups function tests 


```{r}
seu <- readRDS("/Users/rhalenathomas/Documents/Data/FlowCytometry/PhenoID/Analysis/9MBO/prepro_outs/clusters/AllcellLablesMarch25.Rds")

colnames(seu@meta.data)
unique(seu$labels.main.groups)


```




```{r}
# plot on variable

proprotionplots(seu.q,seu.var = seu.q$Genotype, seu.lable = seu.q$cell.types, groups = "Genotype")


```


```{r}

# plot multiple variables and designate colours

colours <- c("chocolate1","chocolate3",
                   "lightsalmon", "pink","lightpink3",
                   "steelblue3","deepskyblue",
                   "plum3","purple",
                   "seagreen3","tomato4","burlywood3","grey90","brown")
# add colours
plotproportions(seu.q, var.list = var.list, xgroup = seu.q$cell.types, varnames = varnames, my_colours = colours)
# leave default colours - if colour variable is not long enough defaults are applied
plotproportions(seu.q, var.list = var.list, xgroup = seu.q$cell.types, varnames = varnames)

```

To see the UMAP split by a given variable we can use the seurat function

```{r}

DimPlot(seu.q, split.by = 'Genotype', group.by = 'cell.types')


```

```{r}

# cell type names
# this must be in the correct order that the cell types appear or else you will be naming things incorrectly
marker.names <-  c("Mix","Neurons1","Astro1","RG1","RG2","Astro2","Astro3","Endothelial","Neurons2","Neurons3","Oligo", "Epithelial")

plotmean(plot_type = 'heatmap',seu = seu.q, group = 'cell.types', markers = AB, 
                     var_names = marker.names, slot = 'scale.data')



```


```{r}
seu <- readRDS("/Users/rhalenathomas/Documents/Data/FlowCytometry/PhenoID/Analysis/9MBO/prepro_outs/clusters/AllcellLablesMarch25.Rds")


```


```{r}
 

```



