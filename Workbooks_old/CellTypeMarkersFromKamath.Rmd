---
title: "R Notebook"
output: html_notebook
---

Identify subtype markers for Neuron and Astrocytes from the Kamath data


```{r}
# set up the environment
library(Seurat)
library(dplyr)
library(Matrix)
library(ggplot2)

```


Read in the data objects

```{r}

DAsubtypes <- readRDS("/Users/rhalenathomas/Documents/Data/scRNAseq/Macosko_Data/DAsubgroups_processed.Rds")


```


Get the subtype makers list to compare with markers

```{r}

Idents(DAsubtypes) <- "Cell_Subtype"

DA.sub.markers <- FindAllMarkers(DAsubtypes, only.pos = TRUE)

```











Check what datasets are in the Seurat Data

```{r}

library(SeuratData)
AvailableData()

# possible good data to take
# humancortexref
# stxBrain



```


Try getting data from UCSC

```{r}

require(Seurat)
require(data.table)
#setwd("adultPancreas")
mat <- fread("https://cells.ucsc.edu/adultPancreas/exprMatrix.tsv.gz")
meta <- data.frame(fread("https://cells.ucsc.edu/adultPancreas/meta.tsv"), row.names=1)
genes = mat[,1][[1]]
genes = gsub(".+[|]", "", genes)
mat = data.frame(mat[,-1], row.names=genes)
so <- CreateSeuratObject(counts = mat, project = "adultPancreas", meta.data=meta)

```


Check out the data object 

```{r}
DimPlot(so) # doesn't have UMAPs
table(so$cluster)
genes = mat[,1][[1]]
genes = gsub(".+[|]", "", genes)
mat = data.frame(mat[,-1], row.names=genes)
so <- CreateSeuratObject(counts = mat, project = "cortex", meta.data=meta)

```


Now download cortex data

Lab: Kriegstein, UCSF
Publication: Nowakowski et al, Science 2017
NCBI DbGaP: phs000989.v3.p1
Submitted by: Aparna Bhaduri (2018-09-06), Version 3
Direct link to this plot for manuscripts: https://cortex-dev.cells.ucsc.edu

```{r}
mat <- fread("https://cells.ucsc.edu/cortex-dev/exprMatrix.tsv.gz")
meta <- data.frame(fread("https://cells.ucsc.edu/cortex-dev/meta.tsv"))
genes = mat[,1][[1]]
genes = gsub(".+[|]", "", genes)
mat = data.frame(mat[,-1], row.names=genes)
so <- CreateSeuratObject(counts = mat, project = "cortex", meta.data=meta)

# all the metadata is NA - can't use

```


Check another data set 

```{r}
mat <- fread("https://cells.ucsc.edu/ms-cross-regional/integrated/exprMatrix.tsv.gz")
meta <- data.frame(fread("https://cells.ucsc.edu/ms-cross-regional/integrated/meta.tsv"))
genes = mat[,1][[1]]
genes = gsub(".+[|]", "", genes)
mat = data.frame(mat[,-1], row.names=genes)
so <- CreateSeuratObject(counts = mat, project = "cortex", meta.data=meta)

# this data set doesn't astrocytes anyway and was too large to load
# this object is too big to load

```

Allen brain cortex

```{r}

require(Seurat)
require(data.table)

mat <- fread("https://cells.ucsc.edu/allen-celltypes/human-cortex/various-cortical-areas/exprMatrix.tsv.gz", nrows = 1000)
meta <- data.frame(fread("https://cells.ucsc.edu/allen-celltypes/human-cortex/various-cortical-areas/meta.tsv"))
genes = mat[,1][[1]]
genes = gsub(".+[|]", "", genes)
mat = data.frame(mat[,-1], row.names=genes)
so <- CreateSeuratObject(counts = mat, project = "cortex", meta.data=meta)

# again too large
# selecting in some doesn't work because the metadata won't be the same order necessarily and it doesn't work if you don't take part of each 

# only 49K cells? 

```

```{r}

# I need to find a small dataset
# 25K

mat <- fread("https://cells.ucsc.edu/human-forebraindev/sc-rna-seq/exprMatrix.tsv.gz")
meta <- data.frame(fread("https://cells.ucsc.edu/human-forebraindev/sc-rna-seq/meta.tsv"))
genes = mat[,1][[1]]
genes = gsub(".+[|]", "", genes)
mat = data.frame(mat[,-1], row.names=genes)
so <- CreateSeuratObject(counts = mat, project = "cortex", meta.data=meta)




```


